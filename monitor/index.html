<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Cache stats</title>

    <script type="text/javascript" src="/js/jquery-1.8.2.min.js"></script>
    <script type="text/javascript" src="/js/highcharts.js"></script>
    <!-- contains the main chart for xebia counter -->
    <script type="text/javascript" src="/js/xebia-highcharts.js"></script>
    <script type="text/javascript" src="/js/sockjs-0.2.1.min.js"></script>
    <script type="text/javascript" src='/js/vertxbus.js'></script>

    <script type="text/javascript">

        var hits=0;
        var eb = new vertx.EventBus(window.location.protocol + '//' + window.location.hostname + ':' + window.location.port + '/monitor-evt-bus');

        eb.onclose = function() {console.log('event bus closed')}

        eb.onopen = function() {
            console.log('event bus opened');
            eb.registerHandler('mongostat.count', function(message) {
                console.log('received count: ' + JSON.stringify(message.count));
                var x=(new Date()).getTime(),
                    y=message.count;
                console.log('add point '+x+','+y);
                countChart.series[0].addPoint([x,y], true, true);
            });

            eb.registerHandler('mongostat.hit', function(message) {
                console.log('received hit: ' + JSON.stringify(message.hit));
                $('#hitsContainer').text(hits++);
            });
        }

    </script>

</head>
<body>

<div id="countContainer" style="width: 400px; height: 300px; margin: 0 auto"></div>
hits: <div id="hitsContainer" style="width: 400px; height: 300px; margin: 0 auto"></div>
</body>
</html>